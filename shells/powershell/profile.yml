---
where: os.name == "windows"

actions:

  - action: command.run
    command: powershell
    args:
      - 'remove-item -LiteralPath "{{ user.home_dir }}/Documents/WindowsPowerShell" -Force -Recurse'

  - action: command.run
    command: powershell
    args:
      - 'new-item -Path "{{ user.home_dir }}/Documents" -Name "WindowsPowerShell" -ItemType "directory"'

  - action: command.run
    command: powershell
    args:
      - 'copy-item "shells/powershell/files/profile/*" -Destination "{{ user.home_dir }}/Documents/WindowsPowerShell" -Recurse -Force'

  # https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7.3
  - action: command.run
    command: powershell
    args:
      - 'copy-item "shells/powershell/files/profile/*" -Destination "{{ user.home_dir }}/Documents/PowerShell" -Recurse -Force'
